<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI DOMINATOR | V12 Parallel Engine</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <div class="app-container">
        
        <header class="cyber-header">
            <div class="logo-section">
                <h1>AI DOMINATOR <span class="version-tag">V12.0 FAST</span></h1>
            </div>
            <div class="system-status">
                <div class="status-dot"></div>
                SYSTEM ONLINE
            </div>
        </header>

        <main class="dashboard-grid">
            <div class="sidebar">
                <div class="cyber-card">
                    <div class="card-title">
                        <h3><i class="fas fa-fingerprint"></i> Ø¨ØµÙ…Ø© Ø§Ù„Ø£Ø³Ù„ÙˆØ¨</h3>
                        <div class="tech-decor-line"></div>
                    </div>
                    <textarea id="sampleText" rows="3" placeholder=">_ Ø§Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§..."></textarea>
                    <button onclick="analyzeStyle()" class="cyber-btn-small"><i class="fas fa-upload"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    <div id="styleStatus" class="status-text"></div>
                    <input type="hidden" id="styleDNA" value="">
                </div>
                <div class="cyber-card" style="margin-top: 25px;">
                    <div class="card-title">
                        <h3><i class="fas fa-sliders-h"></i> Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„ØµÙˆØ±Ø©</h3>
                        <div class="tech-decor-line"></div>
                    </div>
                    <select id="imageStyle">
                        <option value="Cyberpunk, Neon, Futurism">ğŸ”® Ø³Ø§ÙŠØ¨Ø± Ø¨Ø§Ù†Ùƒ</option>
                        <option value="Cinematic Photorealistic, 8k">ğŸ“¸ ÙˆØ§Ù‚Ø¹ÙŠ 8K</option>
                        <option value="3D Render, Unreal Engine">ğŸ§Š 3D Ø±ÙŠÙ†Ø¯Ø±</option>
                    </select>
                </div>
            </div>

            <div class="main-content">
                <div class="cyber-card">
                    <div class="card-title">
                        <h3><i class="fas fa-bolt"></i> Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠ (Parallel Engine)</h3>
                        <div class="tech-decor-line"></div>
                    </div>
                    <textarea id="inputText" rows="3" placeholder=">_ Ø£Ø¯Ø®Ù„ Ø§Ù„ÙÙƒØ±Ø©..."></textarea>
                    <button id="generateBtn" class="cyber-btn-main" onclick="startEngine()">
                        <i class="fas fa-rocket"></i> Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù†ÙØ§Ø«
                    </button>
                </div>

                <div id="outputSection" style="display: none; margin-top: 30px;">
                    <div class="output-grid" id="mainOutputGrid">
                        
                        <div class="image-frame" id="mainImageContainer"></div>
                        
                        <div class="content-wrapper">
                            <div class="tabs-header">
                                <button class="tab-btn active" onclick="openTab('linkedin')"><i class="fab fa-linkedin"></i> LinkedIn</button>
                                <button class="tab-btn" onclick="openTab('twitter')"><i class="fab fa-twitter"></i> Twitter</button>
                                <button class="tab-btn video-tab-btn" onclick="openTab('tiktok')"><i class="fab fa-tiktok"></i> TikTok</button>
                            </div>

                            <div class="cyber-card text-frame">
                                <div id="linkedinContent" class="tab-content active simple-text-content"></div>
                                <div id="twitterContent" class="tab-content simple-text-content"></div>
                                <div id="tiktokContent" class="tab-content cinema-mode">
                                    <h4 class="section-title"><i class="fas fa-images"></i> Storyboard</h4>
                                    <div class="storyboard-grid">
                                        <div class="story-frame" id="storyImg1"></div>
                                        <div class="story-frame" id="storyImg2"></div>
                                        <div class="story-frame" id="storyImg3"></div>
                                    </div>
                                    <h4 class="section-title">Video Prompt</h4>
                                    <div class="video-prompt-box">
                                        <textarea id="videoPromptText" readonly></textarea>
                                        <button class="copy-prompt-btn" onclick="copyPrompt()"><i class="fas fa-copy"></i></button>
                                    </div>
                                    <h4 class="section-title">Script</h4>
                                    <div id="tiktokScriptText" class="script-container"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨
        function openTab(platform) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(platform + 'Content').classList.add('active');
            
            const btnIndex = platform === 'linkedin' ? 0 : platform === 'twitter' ? 1 : 2;
            document.querySelectorAll('.tab-btn')[btnIndex].classList.add('active');

            const mainImage = document.getElementById('mainImageContainer');
            const mainGrid = document.getElementById('mainOutputGrid');

            if (platform === 'tiktok') {
                mainImage.style.display = 'none';
                mainGrid.style.gridTemplateColumns = '1fr';
            } else {
                mainImage.style.display = 'flex';
                mainGrid.style.gridTemplateColumns = '1fr 1fr';
            }
        }

        function loadImage(id, prompt) {
            const el = document.getElementById(id);
            if(!prompt || prompt.length < 5) return;
            el.innerHTML = '<div class="loader-ui small"><i class="fas fa-circle-notch fa-spin"></i></div>';
            const seed = Math.floor(Math.random() * 9999);
            const img = new Image();
            img.src = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?nologin=true&width=1024&height=1024&model=flux&seed=${seed}`;
            img.onload = () => { el.innerHTML = ''; el.appendChild(img); };
        }

        // --- Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠ (Ø§Ù„Ø³Ø± ÙˆØ±Ø§Ø¡ Ø§Ù„Ø³Ø±Ø¹Ø©) ---
        async function startEngine() {
            const text = document.getElementById('inputText').value;
            const style = document.getElementById('styleDNA').value;
            const imgStyle = document.getElementById('imageStyle').value;
            
            if(!text) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");
            
            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-sync fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…Ù†ØµØ§Øª...';
            
            document.getElementById('outputSection').style.display = 'block';
            
            // ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù„ÙƒÙ„ Ù‚Ø³Ù… Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ‚Ù„
            document.getElementById('linkedinContent').innerHTML = '<div class="loader-ui">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± LinkedIn...</div>';
            document.getElementById('twitterContent').innerHTML = '<div class="loader-ui">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Twitter...</div>';
            document.getElementById('tiktokScriptText').innerHTML = '<div class="loader-ui">Ø¬Ø§Ø±ÙŠ Ø¥Ø®Ø±Ø§Ø¬ TikTok...</div>';
            document.getElementById('mainImageContainer').innerHTML = '<div class="loader-ui">Image Loading...</div>';

            const payload = { topic: text, style_dna: style, image_style: imgStyle };

            // 1. Ø¥Ø·Ù„Ø§Ù‚ Ù…Ù‡Ù…Ø© LinkedIn
            fetch('/generate/linkedin', {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload)
            }).then(r => r.json()).then(data => {
                document.getElementById('linkedinContent').innerHTML = data.text.replace(/\n/g, '<br>');
                loadImage('mainImageContainer', data.image);
            });

            // 2. Ø¥Ø·Ù„Ø§Ù‚ Ù…Ù‡Ù…Ø© Twitter (Ø¨Ø§Ù„ØªÙˆØ§Ø²ÙŠ)
            fetch('/generate/twitter', {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload)
            }).then(r => r.json()).then(data => {
                document.getElementById('twitterContent').innerHTML = data.text.replace(/\n/g, '<br>');
            });

            // 3. Ø¥Ø·Ù„Ø§Ù‚ Ù…Ù‡Ù…Ø© TikTok (Ø¨Ø§Ù„ØªÙˆØ§Ø²ÙŠ)
            fetch('/generate/tiktok', {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload)
            }).then(r => r.json()).then(data => {
                document.getElementById('tiktokScriptText').innerHTML = data.text.replace(/\n/g, '<br>');
                document.getElementById('videoPromptText').value = data.video_prompt;
                
                // ØªØ­Ù…ÙŠÙ„ ØµÙˆØ± Ø§Ù„Ø³ØªÙˆØ±ÙŠ Ø¨ÙˆØ±Ø¯ Ø¨Ø§Ù„ØªØªØ§Ø¨Ø¹ Ù„ØªØ®ÙÙŠÙ Ø§Ù„Ø¶ØºØ·
                setTimeout(() => loadImage('storyImg1', data.img1), 500);
                setTimeout(() => loadImage('storyImg2', data.img2), 1500);
                setTimeout(() => loadImage('storyImg3', data.img3), 2500);
            });

            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ù‚ØµÙŠØ±Ø©
            setTimeout(() => {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-rocket"></i> Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù†ÙØ§Ø«';
            }, 5000);
            
            openTab('linkedin');
        }
        
        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ØµØºÙŠØ±Ø©
        function analyzeStyle() { alert("ØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„!"); document.getElementById('styleDNA').value = "Professional"; }
        function copyPrompt() { navigator.clipboard.writeText(document.getElementById('videoPromptText').value); alert("ØªÙ… Ø§Ù„Ù†Ø³Ø®"); }
    </script>
</body>
</html>
