<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Dominator | 2050 Edition</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="matrix-bg"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <div class="app-container">
        
        <header class="glass-header" data-tilt>
            <div class="logo-glitch" data-text="AI DOMINATOR">AI DOMINATOR</div>
            <div class="status-badge"><span class="pulse"></span> ONLINE V6.0</div>
        </header>

        <main>
            <div class="control-deck">
                
                <div class="card holographic" data-tilt>
                    <div class="card-content">
                        <h3><i class="fas fa-fingerprint"></i> Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ø±ÙˆØ­ (DNA)</h3>
                        <textarea id="sampleText" placeholder="Ø§Ù„ØµÙ‚ Ø¹ÙŠÙ†Ø© Ù…Ù† Ø£Ø³Ù„ÙˆØ¨Ùƒ Ù‡Ù†Ø§ Ù„Ù„ØªØ­Ù„ÙŠÙ„..."></textarea>
                        <button class="cyber-btn" onclick="analyzeStyle()">
                            <span class="btn-glitch"></span>
                            <span class="btn-content">ğŸ§¬ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø³ØªÙ†Ø³Ø§Ø®</span>
                        </button>
                        <div id="styleStatus" class="status-line"></div>
                        <input type="hidden" id="styleDNA" value="">
                    </div>
                </div>

                <div class="card holographic primary-card" data-tilt>
                    <div class="card-content">
                        <h3><i class="fas fa-meteor"></i> Ù…Ø±ÙƒØ² Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</h3>
                        
                        <div class="style-selector">
                            <label><i class="fas fa-palette"></i> Ù†Ù…Ø· Ø§Ù„ØµÙˆØ±Ø©:</label>
                            <select id="imageStyle" class="cyber-select">
                                <option value="Cinematic Photorealistic, 8k, detailed texture">ğŸ“¸ ÙˆØ§Ù‚Ø¹ÙŠ Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ (Realistic)</option>
                                <option value="Cyberpunk, Neon Lights, Futuristic, Sci-fi">ğŸ”® Ø³Ø§ÙŠØ¨Ø± Ø¨Ø§Ù†Ùƒ (Cyberpunk)</option>
                                <option value="3D Render, Pixar Style, Cute, Colorful">ğŸ§¸ ÙƒØ±ØªÙˆÙ† 3D (Pixar Style)</option>
                                <option value="Minimalist, Vector Art, Flat Design">âœï¸ Ø±Ø³Ù… Ù…Ø¨Ø³Ø· (Minimalist)</option>
                                <option value="Luxury, Gold and Black, Elegant">ğŸ‘‘ ÙØ®Ø§Ù…Ø© (Luxury)</option>
                                <option value="Anime Style, Studio Ghibli, Vibrant">ğŸ‡¯ğŸ‡µ Ø£Ù†Ù…ÙŠ (Anime)</option>
                            </select>
                        </div>

                        <textarea id="inputText" placeholder="Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ù‡Ù†Ø§... (Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹)"></textarea>
                        
                        <button id="generateBtn" class="cyber-btn mega-btn" onclick="remixContent()">
                            <span class="btn-glitch"></span>
                            <span class="btn-content">ğŸš€ Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù†ÙˆÙˆÙŠ</span>
                        </button>
                    </div>
                </div>
            </div>

            <div id="outputSection" class="output-deck" style="display: none;">
                
                <div class="insight-terminal" id="insightBox" style="display:none;">
                    <div class="terminal-header">
                        <span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span>
                        <span class="terminal-title">AI_CRITIC_LOGS.txt</span>
                    </div>
                    <p id="insightText" class="terminal-body"></p>
                </div>

                <div class="result-grid">
                    <div class="frame-3d" data-tilt>
                        <div class="frame-content">
                            <div class="glow-effect"></div>
                            <div class="image-wrapper" id="imageContainer">
                                <div class="loading-scanner">
                                    <div class="scan-line"></div>
                                    <i class="fas fa-eye fa-2x"></i>
                                    <p>RENDERING...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="frame-3d text-frame" data-tilt>
                        <div class="frame-content">
                            <div class="card-tools">
                                <span>VIRAL_CONTENT_GENERATED</span>
                                <button onclick="copyText()"><i class="fas fa-copy"></i></button>
                            </div>
                            <div class="result-text" id="resultText"></div>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <script>
        // ØªØ£Ø«ÙŠØ± Tilt 3D (Ø­Ø±ÙƒØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ø¹ Ø§Ù„Ù…Ø§ÙˆØ³)
        document.addEventListener('mousemove', (e) => {
            document.querySelectorAll('[data-tilt]').forEach(card => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                const rotateX = ((y - centerY) / centerY) * -5; // Ø¹ÙƒØ³ Ø§Ù„Ù…Ø­ÙˆØ± Ù„ØªØ¨Ø¯Ùˆ Ø·Ø¨ÙŠØ¹ÙŠØ©
                const rotateY = ((x - centerX) / centerX) * 5;

                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
            });
        });

        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ù„ÙˆØ¶Ø¹Ù‡Ø§ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
        document.addEventListener('mouseout', () => {
            document.querySelectorAll('[data-tilt]').forEach(card => {
                card.style.transform = `perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)`;
            });
        });

        // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… ---
        async function analyzeStyle() {
            const text = document.getElementById('sampleText').value;
            const status = document.getElementById('styleStatus');
            if(!text || text.length < 20) return alert("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ© Ù„Ù„ØªØ­Ù„ÙŠÙ„!");
            status.innerHTML = '<span class="blink">SCANNING DNA...</span>';
            status.className = "status-line active";
            
            try {
                const res = await fetch('/analyze-style', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({text})});
                const data = await res.json();
                if(data.style_dna) {
                    document.getElementById('styleDNA').value = data.style_dna;
                    status.innerHTML = '<span style="color:#00ff88">âœ” DNA SEQUENCE LOCKED</span>';
                }
            } catch(e) { status.innerHTML = 'ERROR'; }
        }

        async function remixContent() {
            const text = document.getElementById('inputText').value;
            const style = document.getElementById('styleDNA').value;
            const imageStyle = document.getElementById('imageStyle').value; // Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØ§Ø±
            const btn = document.getElementById('generateBtn');

            if(!text) return alert("Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø©!");

            btn.innerHTML = '<span class="btn-content">âš¡ SYSTEM PROCESSING...</span>';
            btn.disabled = true;
            document.getElementById('outputSection').style.display = 'block';
            document.getElementById('resultText').innerHTML = '<div class="matrix-loader">Decrypting...</div>';
            document.getElementById('imageContainer').innerHTML = '<div class="loading-scanner"><div class="scan-line"></div><p>RENDERING PIXELS...</p></div>';

            try {
                const res = await fetch('/generate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({text: text, style: style, image_style: imageStyle})
                });
                const data = await res.json();

                if(!data.error) {
                    document.getElementById('resultText').innerHTML = data.result.replace(/\n/g, '<br>');
                    if(data.debug) {
                        document.getElementById('insightBox').style.display = 'block';
                        document.getElementById('insightText').innerText = data.debug;
                    }

                    // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØ§Ø±
                    const imgUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(data.image_prompt)}?nologin=true&width=1024&height=1024&model=flux&seed=${Math.floor(Math.random()*1000)}`;
                    const img = new Image();
                    img.onload = () => { document.getElementById('imageContainer').innerHTML = ''; document.getElementById('imageContainer').appendChild(img); };
                    img.src = imgUrl;
                }
            } catch(e) { document.getElementById('resultText').innerText = "SYSTEM FAILURE"; }
            
            btn.innerHTML = '<span class="btn-glitch"></span><span class="btn-content">ğŸš€ Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù†ÙˆÙˆÙŠ</span>';
            btn.disabled = false;
        }

        function copyText() { navigator.clipboard.writeText(document.getElementById('resultText').innerText); alert("COPIED TO CLIPBOARD"); }
    </script>
</body>
</html>
